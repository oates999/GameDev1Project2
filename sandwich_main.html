<html>
<head>
	<meta charset="UTF-8" />
	<title>Sandwich Game Placeholder Title</title>
	<script type="text/javascript" src="js/phaser.min.js"></script>
	<style text="text/css">
		body {
			margin: 0;
		}
	</style>
</head>

<body>
<script type="text/javascript">

var game = new Phaser.Game(750, 1334, Phaser.AUTO, '',
	{preload: preload, create: create, update: update});
//Global Variables
var wheel;
var leftTween;
var rightTween;
var tween_duration = 200;
var last_spin;

//Temporary Variables
var key1;
var key2;

//falling objects
//list of all possible, randomly choose 1 and drop it from the top. Slightly random time between drops. 
var possibleItems = [];
var nextFall;
var fallTimeMin = 2000;
var fallTimeMax = 4000;
var fallSpeed;

var toDrop;
var newItem;
var fallingItems = [];


function preload() {

    //load wheel
    game.load.image("wheel_sprite", "assets/images/placeholder/placeholder_wheel.png");
    //load falling food assests
    game.load.image("tomato", "assets/images/placeholder/tomato.png");
    possibleItems.push("tomato");

}

function create() {


    //set lastfall to the current time
    nextFall = game.time.time + Math.random() * fallTimeMax;

	game.physics.startSystem(Phaser.Physics.ARCADE);
	wheel = game.add.sprite(0, 0, "wheel_sprite");
	wheel.width = 700;
	wheel.height = 700;
	wheel.anchor.set(0.5, 0.5);
	wheel.x = game.width/2;
	wheel.y = game.height - 250;
	wheel.angle -= 45;

	leftTween = game.add.tween(wheel).to({angle: "-90"}, tween_duration, Phaser.Easing.Linear.None, true, 100);
	rightTween = game.add.tween(wheel).to({angle: "+90"}, tween_duration, Phaser.Easing.Linear.None, true, 100);

	key1 = game.input.keyboard.addKey(Phaser.Keyboard.LEFT);
	key1.onDown.add(spin_left, this);
	key2 = game.input.keyboard.addKey(Phaser.Keyboard.RIGHT);
	key2.onDown.add(spin_right, this);
}

function update() {
    if (game.time.time > nextFall) {
        //generate a random number to determine which ingredient to drop
        toDrop = Math.floor(Math.random() * (possibleItems.length - 1));
        newItem = game.add.sprite(game.width / 2, 0, possibleItems[toDrop]);
        game.physics.enable(newItem);
        newItem.anchor.set(0.5);
        newItem.body.maxVelocity.set(300);
        newItem.body.acceleration.y = 100;
        fallingItems.push(newItem);
        nextFall = fallTimeMin + game.time.time + Math.random() * fallTimeMax;
    }
}

function spin_left() {
	var current_time = this.time.now;
	if (current_time - last_spin > tween_duration) {
		leftTween.start();
		last_spin = this.time.now;
	}
}
function spin_right() {
	var current_time = this.time.now;
	if (current_time - last_spin > tween_duration) {
		rightTween.start();
		last_spin = this.time.now
	}
}

</script>
</body>
</html>