<html>
<head>
	<meta charset="UTF-8" />
	<title>Sandwich Game Placeholder Title</title>
	<script type="text/javascript" src="js/phaser.min.js"></script>
	<style text="text/css">
		body {
			margin: 0;
		}
	</style>
</head>

<body>
<script type="text/javascript">

//Global Variables
var game = new Phaser.Game(750, 1334, Phaser.AUTO, '',
	{preload: preload, create: create, update: update});
var wheel;						//wheel object
	var leftTweenAlpha;				//wheel rotation left (major)
	var leftTweenBeta;				//wheel rotation left (minor)
	var rightTweenAlpha;			//wheel rotation right (major)
	var rightTweenBeta;				//wheel rotation right (minor)
var tween_duration = 200;		//duration of tween (ms)
var x_on_start;					//data storage for swipe detect
var x_on_stop;
var y_on_start;
var y_on_stop;

var plate_1;
	var plate1_tweenAlpha;
	var plate1_tweenBeta;
var plate_2;
	var plate2_tweenAlpha;
	var plate2_tweenBeta;
var plate_3;
	var plate3_tweenAlpha;
	var plate3_tweenBeta;

//Temporary Variables
var key1;
var key2;

function preload () {
	game.load.image("wheel_sprite", "assets/images/placeholder/placeholder_wheel.png");
	game.load.image("plate_sprite", "assets/images/placeholder/placeholder_plate.png");
}

function create() {
	game.physics.startSystem(Phaser.Physics.ARCADE);
	game.input.mouse.capture = true;

	//Creation and positioning of the wheel
	wheel = game.add.sprite(0, 0, "wheel_sprite");
	wheel.inputEnabled = true;
	wheel.width = 700;
	wheel.height = 700;
	wheel.anchor.set(0.5, 0.5);
	wheel.x = game.width/2;
	wheel.y = game.height;
	wheel.angle -= 45;
	//Creation and positioning of the plates (children of the wheel)
	plate_1 = game.add.sprite(0, 0, 'plate_sprite');
	wheel.addChild(plate_1);
	plate_1.anchor.set(0.5, 0.5);
	plate_1.x = 300;
	plate_1.y = 300;
	plate_1.angle -= 45;
	plate_2 = game.add.sprite(0, 0, 'plate_sprite');
	wheel.addChild(plate_2);
	plate_2.anchor.set(0.5, 0.5);
	plate_2.x = -300;
	plate_2.y = -300;
	plate_2.angle += 135;
	plate_3 = game.add.sprite(0, 0, 'plate_sprite');
	wheel.addChild(plate_3);
	plate_3.anchor.set(0.5, 0.5);
	plate_3.x = 300;
	plate_3.y = -300;
	plate_3.angle += 45;
	

	//Defining of the wheel-spin tweens
	leftTweenAlpha = game.add.tween(wheel).to({angle: "-110"}, tween_duration, Phaser.Easing.Quadratic.InOut);
	leftTweenBeta = game.add.tween(wheel).to({angle: "-20"}, tween_duration, Phaser.Easing.Quadratic.InOut);
	rightTweenAlpha = game.add.tween(wheel).to({angle: "+110"}, tween_duration, Phaser.Easing.Quadratic.InOut);
	rightTweenBeta = game.add.tween(wheel).to({angle: "+20"}, tween_duration, Phaser.Easing.Quadratic.InOut);
	leftTweenAlpha.chain(rightTweenBeta);
	rightTweenAlpha.chain(leftTweenBeta);
	//Defining of the plate tweens
	plate1_tweenAlpha = game.add.tween(plate_1).to({x: "+100", y: "+100"}, tween_duration, Phaser.Easing.Quadratic.InOut);

	//Defining function call when mouse is clicked/released
	game.input.onDown.add(onClick, this);
	game.input.onUp.add(onRelease, this);
}

function update() {

}

//Function called on left-click start
function onClick() {
	x_on_start = game.input.mousePointer.x;
	y_on_start = game.input.mousePointer.y;
}
//Function called on left-click release
function onRelease() {
	x_on_stop = game.input.mousePointer.x;
	y_on_stop = game.input.mousePointer.y;
	var distX = x_on_stop - x_on_start;
	var distY = y_on_stop - y_on_start;
	//Swipe was horizontal (distX more that twice as large as distY)
	if (Math.abs(distX) > Math.abs(distY)*2 && Math.abs(distX) > 10) {
		//Left Swipe
		if (distX < 0) {
			if (wheel.angle % 90 === 45 || wheel.angle % 90 === -45)
				leftTweenAlpha.start();
		}
		//Right Swipe
		else {
			if (wheel.angle % 90 === 45 || wheel.angle % 90 === -45)
				rightTweenAlpha.start();
		}
	}
}

</script>
</body>
</html>